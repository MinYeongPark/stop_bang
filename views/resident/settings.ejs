<%- include('./residentMenu.ejs'); %>
<script>
  function checkSetting() {
    let number = document.getElementById("residentPhone").value;
    console.log(number);
    if (/^[0-9]{3}-[0-9]{4}-[0-9]{4}$/.test(number)) {
      document.getElementById("checkPhoneMessage").innerText = "";
      alert("변경 사항이 저장되었습니다.");
      return true;
    } else {
      document.getElementById("checkPhoneMessage").innerText =
        "010-0000-0000 형식으로 입력해주세요.";
      return false;
    }
  }

  function checkPassword() {
    let pw = document.getElementById("newpw").value;
    let pw2 = document.getElementById("newpw2").value;
    if (pw !== pw2) {
      document.getElementById("checkpw").innerText =
        "비밀번호를 다시 확인해주세요.";
      return false;
    } else if (pw.length < 6) {
      document.getElementById("checkpw").innerText =
        "비밀번호를 5자 이상으로 설정해주세요.";
      return false;
    } else {
      document.getElementById("checkpw").innerText = "";
      return true;
    }
  }
</script>
<div class="mypage-container">
  <h3 class="mypage-hr">계정 정보</h3>
  <form
    classname="user-setting"
    action="/resident/settings/update"
    method="post"
  >
    <label class="user-label">🧸 아이디</label>
    <input
      class="uk-input uk-form-width-medium"
      name="username"
      value="<%= resident.r_username %>"
      placeholder="아이디"
      readonly="true"
    />
    <br />
    <label class="user-label">✅ 실명</label>
    <input
      class="uk-input uk-form-width-medium"
      value="<%= resident.r_realname %>"
      required
    />
    <br />
    <label class="user-label">📞 전화번호</label>
    <input
      id="residentPhone"
      class="uk-input uk-form-width-medium"
      name="phone"
      value="<%= resident.r_phone %>"
    />
    <label id="checkPhoneMessage"></label>
    <br />
    <label class="user-label">📬 이메일</label>
    <input
      class="uk-input uk-form-width-medium"
      name="email"
      value="<%= resident.r_email %>"
      type="email"
    />
    <br />
    <label id="residentBirth" class="user-label">🎂 생년월일</label>
    <input class="uk-input uk-form-width-medium" name="birth" type="date"
    max="new Date()" placeholder="생년월일 입력하고 휴지 받기" value="<%=
    resident.r_birth === null ? '' : Intl.DateTimeFormat("fr-CA", {year:
    "numeric", month: "2-digit", day: "2-digit"}).format(resident.r_birth) %>"
    />
    <br />
    <div class="layout-row">
      <label class="user-label">🧻 나의 휴지</label>
      <span class="uk-badge" style="margin-right: 30px;"><%= resident.r_point%></span>
      <span class="abouttissue" style="margin-right: 10px">※휴지란?</span>
      <a href="#modal-center" uk-toggle><i class="ri-question-line"></i></a>

      <div id="modal-center" class="uk-flex-top" uk-modal>
        <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical">

          <button class="uk-modal-close-default" type="button" uk-close></button>

          <p>
            <div style="text-align: center;">
              <h3>휴지로 후기를 열람하세요!</h3>
              <p>2️⃣🧻를 사용하여 후기를 열람할 수 있습니다.</p>
            </div>
            <h4>🧻 모으기</h4>
            <table class="uk-table uk-table-striped">
              <tr>
                <td>회원가입</td>
                <td>+2️⃣🧻</td>
              </tr>
              <tr>
                <td>첫 후기 작성</td>
                <td>+5️⃣🧻</td>
              </tr>
              <tr>
                <td>후기 작성</td>
                <td>+3️⃣🧻</td>
              </tr>
              <tr>
                <td>생일 입력</td>
                <td>+1️⃣🧻</td>
              </tr>
              <tr>
                <td>생일 축하</td>
                <td>+1️⃣🧻</td>
              </tr>
              <tr>
                <td>전화번호 인증</td>
                <td>+3️⃣🧻</td>
              </tr>
            </table>
          </p>

        </div>
      </div>
    </div>
    <button
      class="user-submit-button uk-button uk-button-default"
      type="submit"
      onclick="return checkSetting()"
    >
      변경 내용 저장하기
    </button>
  </form>
  <br />

  <h3 class="mypage-hr">비밀번호 재설정</h3>
  <form action="/resident/settings/pwupdate" method="post">
    <label class="user-label">🔑 현재 비밀번호</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input
        class="uk-input uk-form-width-medium"
        name="oldpassword"
        type="password"
        aria-label="Not clickable icon"
        required
      />
    </div>
    <br />

    <label class="user-label">🔓 새 비밀번호</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input
        id="newpw"
        name="password"
        class="uk-input uk-form-width-medium"
        type="password"
        aria-label="Not clickable icon"
        required
      />
    </div>
    <br />
    <label class="user-label">🔒 새 비밀번호 확인</label>
    <div class="uk-inline">
      <span class="uk-form-icon uk-form-icon-flip" uk-icon="icon: lock"></span>
      <input
        id="newpw2"
        class="uk-input uk-form-width-medium"
        type="password"
        aria-label="Not clickable icon"
        required
      />
    </div>
    <label id="checkpw"></label>
    <br />
    <button
      class="user-submit-button uk-button uk-button-default"
      type="submit"
      onclick="return checkPassword()"
    >
      비밀번호 변경하기
    </button>
  </form>
</div>
